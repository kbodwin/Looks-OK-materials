---
title: "NBA Player of the Week"
output: html_document
# Warning:  File created automatically from /Users/spareaccount/Documents/internship/that-seems-ok-to-me/NBA_Player_of_the_Week/nba_analysis.Rmd
# Do NOT edit this file directly, as it may be overwritten.
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, eval = TRUE)
library(tidyverse)
library(infer)
```


# Data Documentation: NBA Player of the Week 1984-2018

## Context

In the National Basketball Association (NBA), games are played between Fall and Spring each year, ending with a set of playoff games and a championship.  One "season" of games thus spans two calendar years. For example, the 2019-2020 season began on October 22, 2019 and will end on April 15, 2020. The playoffs will begin on April 18, 2020, and will end with the NBA Finals in June 2020. 

Teams in the NBA are organized into two Conferences:  East and West.  From time to time, as teams change locations or new teams are added, the conferences change.

Players join the NBA by being *drafted*, typically when they are 18 years old.

## This dataset

The dataset in this exam contains information about the "Player of the Week", awarded each week to the player(s) who performed the best during that week's games. 

Each observation in this dataset represents an instance of a certain player being awarded Player of the Week.

The variables in this dataset are:

![](/Users/spareaccount/Documents/internship/that-seems-ok-to-me/NBA_Player_of_the_Week/documentation.png)

```{r, message = FALSE}
nba <-read_csv("/Users/spareaccount/Documents/internship/that-seems-ok-to-me/NBA_Player_of_the_Week/NBA_player_of_the_week.csv")
```

# Data Cleaning and Adjusting





## Heights and Weights

Notice that the `Height` variable is sometimes recorded in inches ("5-9"), and sometimes recorded in centimeters ("221cm").  Similarly, the `Weight` variable is in pounds by default, but sometimes appears in kilograms. 

We need to fix these variables to be consistently in inches and in pounds.


```{r}

fix_height <- function(height) {
  
  # Find misrecorded heights
  is_cm <- str_detect(height, "cm")
  
  # Swap cm to inches
  height[is_cm] <- height[is_cm] %>%
    parse_number(.)*0.394
  
  # Change feet-inches to inches
  height[!is_cm] <- height[!is_cm] %>%
    str_split("-") %>%
    map_dbl(~as.numeric(.x[1])*12 +  as.numeric(.x[2]))
  
  as.numeric(height)
  
}

fix_weight <- function(weight) {
  
  # Find misrecorded weights
  is_kg <- str_detect(weight, "kg")
  
  # Swap to pounds
  weight[is_kg] <- weight[is_kg] %>%
    parse_number(.)*2.2
  
  as.numeric(weight)
  
}

```

```{r}
nba <- nba %>%
  mutate(
    Height = fix_height(Height),
    Weight = fix_weight(Weight)
  )
```

# Player summaries

Number of unique players who have won "Player of the Week" in the timespan covered by this dataset:

```{r}
nba %>%
  distinct(Player) %>%
  nrow()
```

The teams that have had a player win the award the most times are:

```{r}
nba %>%
  count(Team) %>%
  top_n(3, n)
```

The players that have won the Player of the Week Award the most times are:
```{r}
nba %>%
  count(Player) %>%
  top_n(3, n)
```

# Positions and size

Basketball players play in "guard" positions (PG, SG, G) or "forward" positions (F, C, F-C, FC, G-F, GF, PF, SF).  It is generally expected that forwards are much taller than guards.  We will use the players in this dataset to analyze size differences between these positions.


## Unique players

We need to narrow down the dataset so that each unique player only appears once.  Since heights and weights are sometimes changing over the years, we will use the median measurement for each unique player.



```{r, warning = FALSE}
nba %>%
  group_by(Player) %>%
  summarize(
    Height = median(as.numeric(Height), na.rm = TRUE),
    Weight = median(as.numeric(Weight), na.rm = TRUE),
    Position = Position[1])

```



## Refactoring position variable

We will create a new variable that identifies each player as simply a Guard or a Forward.


```{r}

nba <- nba %>% 
  mutate(
    Position_GF = fct_collapse(Position,
      Guard = c("PG", "SG", "G"),
      Forward = c("F", "C", "F-C", "FC", "G-F", "GF", "PF", "SF")
    )
  ) 

```

## Comparing Heights

The following plots show the heights and weights of players, separated by position.

```{r}
nba %>%
  ggplot(aes(x = Position_GF, y = Height)) +
  geom_boxplot() +
  xlab("Position")

nba %>%
  ggplot(aes(x = Position_GF, y = Weight)) +
  geom_boxplot() +
  xlab("Position")
  
```


It is clear from these boxplots that Forwards tend to be taller and weight more than Guards.  

It appears from the plots that the Forwards in the dataset have a mean height of about 81 inches, while Guards have a mean height of 75.3 inches. Forwards have a mean weight of about 245 pounds, while Guards have a mean weight of 200 pounds.







# Different Guard positions

Among the Guard positions, there are two specialties:  Point Guard (PG) and Shooting Guard (SG).  We are interested in studying whether these positions also have a height difference.

The sample mean for each position is given below.

```{r}
nba %>%
  filter(Position %in% c("PG", "SG")) %>%
  group_by(Position) %>%
  summarize(mean(Height))
```

We will conduct a t-test at the 0.05 level.




```{r}
my_test <- 
  nba %>%
    filter(Position %in% c("PG", "SG")) %>%
    t_test(Height ~ Position,
           order = c("PG", "SG"),
           alternative = "two.sided"
    )
```





We obtain a t statistic of `r my_test$t_df`. This yields a p-value of `r my_test$p_value`.


We fail to reject the null hypothesis, and find that there is no detectable height difference between Point Guards and Shooting Guards.


